ğŸ“Œ Trade Bot OrtamÄ±na EriÅŸim ve Aktivasyon NotlarÄ±

Bu dosya, sistem yeniden baÅŸlatÄ±ldÄ±ÄŸÄ±nda veya VS Code Ã¼zerinden SSH baÄŸlantÄ±sÄ± kurulduÄŸunda trade bot ortamÄ±na nasÄ±l geÃ§ileceÄŸini ve Python ortamÄ±nÄ±n nasÄ±l aktifleÅŸtirileceÄŸini adÄ±m adÄ±m aÃ§Ä±klar.

---

ğŸ” 1. SSH ile BaÄŸlantÄ± Kur

Terminal veya VS Code Remote-SSH Ã¼zerinden aÅŸaÄŸÄ±daki profil ile baÄŸlan:

    ssh Selbir

Bu baÄŸlantÄ±, `selbir` kullanÄ±cÄ±sÄ± ile sunucuya eriÅŸim saÄŸlar.

---

ğŸ“ 2. Trade Bot Dizinine GeÃ§

BaÄŸlantÄ± kurulduktan sonra aÅŸaÄŸÄ±daki komutla trade bot dizinine geÃ§:

    cd /opt/tradebot

Bu dizin, tÃ¼m uygulama dosyalarÄ±nÄ± ve Python ortamÄ±nÄ± iÃ§erir.

---

ğŸ 3. Python OrtamÄ±nÄ± AktifleÅŸtir

Trade bot iÃ§in izole Python ortamÄ±nÄ± aktifleÅŸtirmek iÃ§in:

    source trade_env/bin/activate

Bu komut ortamÄ± aktif hale getirir. Terminalde `(trade_env)` ibaresi gÃ¶rÃ¼nÃ¼r.

---

ğŸ§ª 4. OrtamÄ±n Aktif OlduÄŸunu Kontrol Et

AÅŸaÄŸÄ±daki komutlarla ortamÄ±n doÄŸru ÅŸekilde aktifleÅŸtiÄŸini doÄŸrulayabilirsin:

    which python
    pip list

Beklenen Ã§Ä±ktÄ±:
- Python yolu: `/opt/tradebot/trade_env/bin/python`
- Paket listesi: Flask, gunicorn, requests vb.

---

ğŸ›‘ 5. Ortamdan Ã‡Ä±kmak Ä°Ã§in

Ä°ÅŸin bittiÄŸinde ortamdan Ã§Ä±kmak iÃ§in:

    deactivate

Bu komut seni sistem Pythonâ€™una geri dÃ¶ndÃ¼rÃ¼r.

---

ğŸ“¦ 6. Uygulama DosyalarÄ±

Trade botun ana dosyalarÄ± bu dizindedir:

    /opt/tradebot/app.py
    /opt/tradebot/config.json
    /opt/tradebot/logs/

Gerekirse `gunicorn` ile Ã§alÄ±ÅŸtÄ±rmak iÃ§in:

    gunicorn --workers 2 --bind 0.0.0.0:3000 app:app

---

âœ… Notlar

- TÃ¼m dosyalar â€œselbirâ€ kullanÄ±cÄ±sÄ±na ait olmalÄ±dÄ±r.
- Root yetkisi sadece sistem yÃ¶netimi iÃ§in kullanÄ±lmalÄ±dÄ±r.
- Ortam ve dizin yapÄ±sÄ± sÃ¼rdÃ¼rÃ¼lebilir mimariye gÃ¶re tasarlanmÄ±ÅŸtÄ±r.

sudo lsof -i :3000   3000 portunu kim kulllanÄ±yor onun Ã§Ä±ktsÄ±nÄ± veren komut

Gunicorn Ã¼zerinden Ã§alÄ±ÅŸÄ±yor ve Nginx onu dÄ±ÅŸ dÃ¼nyaya aÃ§Ä±yor. Yani:

Kod dosyan: /opt/tradebot/test_app_1.py

Flask uygulaman: Bu dosyada tanÄ±mlÄ± app = Flask(__name__)

HTML veya iÃ§erik eklemek istiyorsan: Flask iÃ§inde render_template() ile HTML dosyalarÄ± kullanabilirsin


sudo rm /etc/nginx/sites-enabled/tradebot
Bu, tradebot yapÄ±landÄ±rmasÄ±nÄ± devre dÄ±ÅŸÄ± bÄ±rakÄ±r ama silmez. Dosya hÃ¢lÃ¢ sites-available iÃ§inde durur.

SYSTEMD Uygulama komut ve iÅŸlemier

systemd edit: sudo systemctl edit tradebot-global.service
doÄŸrudan dosyayÄ± da aÃ§ma komutu: sudo nano /etc/systemd/system/tradebot-global.service.d/override.conf

DoÄŸrula:    systemctl cat tradebot-global.service
            systemctl show -p Restart,RestartUSec,KillMode,TimeoutStopUSec,StartLimitIntervalUSec,StartLimitBurst tradebot-global.service
            journalctl -fu tradebot-global.service



Mevcut drop-in klasÃ¶rÃ¼nÃ¼ ve kalÄ±ntÄ±larÄ± gÃ¶r: sudo ls -la /etc/systemd/system/tradebot-global.service.d

TÃ¼m systemd override dizinlerini taramak: sudo find /etc/systemd/system/ -type f \( -name '*~' -o -name '#*#' -o -name '.#*' \)

Temizleme: sudo find /etc/systemd/system/ -type f \( -name '*~' -o -name '#*#' -o -name '.#*' \) -exec rm -f {} +

KalÄ±ntÄ±larÄ± sil:    sudo rm -f /etc/systemd/system/tradebot-global.service.d/.#override.conf*
                    sudo rm -f /etc/systemd/system/tradebot-global.service.d/#override.conf#
                    sudo rm -f /etc/systemd/system/tradebot-global.service.d/override.conf~


systemdâ€™yi yenile ve servisi baÅŸlat:    sudo systemctl daemon-reload
                                        sudo systemctl restart tradebot-global.service

KONTROL LÄ°STESÄ° (HÄ±zlÄ± doÄŸrulama)
systemd
# Drop-in iÃ§erik kontrol
systemctl cat tradebot-global.service

# Parametrelerin yÃ¼klendiÄŸini doÄŸrula
systemctl show -p Restart,RestartUSec,KillMode,TimeoutStopUSec,StartLimitIntervalUSec,StartLimitBurst tradebot-global.service
# beklenen: Restart=on-failure, RestartUSec=5s, KillMode=control-group, TimeoutStopUSec=30s, StartLimitIntervalUSec=1min, StartLimitBurst=8

# CanlÄ± log
journalctl -fu tradebot-global.service

Playwright depolarÄ± & izinler
sudo install -d -o selbir -g selbir -m 775 /opt/tradebot/tmp/chrome-profiles
sudo install -d -o selbir -g selbir -m 775 /opt/tradebot/pw-browsers

DB ÅŸema & veri akÄ±ÅŸÄ±
# periyot kapanÄ±ÅŸ tablolarÄ±
sqlite3 /opt/tradebot/veritabani/global_data.db ".schema global_close_15m"
sqlite3 /opt/tradebot/veritabani/global_data.db "SELECT * FROM global_close_15m ORDER BY ts_bucket_utc DESC LIMIT 3;"
sqlite3 /opt/tradebot/veritabani/global_data.db "SELECT * FROM global_close_1h  ORDER BY ts_bucket_utc DESC LIMIT 3;"
sqlite3 /opt/tradebot/veritabani/global_data.db "SELECT * FROM global_close_4h  ORDER BY ts_bucket_utc DESC LIMIT 3;"

# gÃ¼nlÃ¼k kapanÄ±ÅŸ
sqlite3 /opt/tradebot/veritabani/global_data.db ".schema global_closing_data"
sqlite3 /opt/tradebot/veritabani/global_data.db "SELECT timestamp,symbol,price,interval FROM global_closing_data ORDER BY timestamp DESC LIMIT 3;"

# canlÄ± akÄ±ÅŸ
sqlite3 /opt/tradebot/veritabani/global_data.db "SELECT * FROM global_live_data ORDER BY timestamp DESC LIMIT 3;"
